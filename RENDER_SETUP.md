# Настройка проекта на Render

## Создание базы данных PostgreSQL

1. Войдите в панель управления Render
2. Выберите "New" → "PostgreSQL"
3. Заполните форму создания:
   - **Name**: beautycity-db (или любое другое имя)
   - **Database**: оставьте значение по умолчанию
   - **User**: оставьте значение по умолчанию
   - **Region**: выберите регион, ближайший к вашим пользователям
   - **PostgreSQL Version**: оставьте значение по умолчанию
   - **Plan Type**: выберите бесплатный план для тестирования
4. Нажмите "Create Database"
5. После создания базы данных, перейдите на страницу базы данных и скопируйте **Internal Database URL**

## Настройка веб-сервиса

1. Выберите "New" → "Web Service"
2. Подключите свой репозиторий GitHub
3. Заполните настройки сервиса:
   - **Name**: beautycity-app (или любое другое имя)
   - **Region**: выберите **тот же регион**, что и для базы данных
   - **Branch**: выберите ветку для деплоя (обычно main или master)
   - **Build Command**: `chmod +x build.sh start.sh && ./build.sh`
   - **Start Command**: `./start.sh`
4. В разделе "Environment Variables" добавьте следующие переменные:
   - `RENDER=true`
   - `DATABASE_URL=postgresql://user:password@postgres.internal:5432/db_name` (вставьте **Internal Database URL**, скопированный ранее, убедитесь, что URL начинается с `postgresql://`)
   - `SECRET_KEY=` (создайте надежный секретный ключ, например `python -c "import secrets; print(secrets.token_hex(24))"`)
   - `ALLOWED_HOSTS=.onrender.com,localhost,127.0.0.1` (добавьте домен Render и другие необходимые хосты)
   - `TELEGRAM_TOKEN=` (добавьте токен вашего Telegram-бота, если используется)
5. Убедитесь, что в разделе "Advanced" → "Auto-Deploy" выбрано "Yes"
6. Нажмите "Create Web Service"

## Важно: Формат DATABASE_URL

Внимательно проверьте формат переменной `DATABASE_URL`. Она должна иметь следующий формат:

```
postgresql://username:password@postgres.internal:5432/database_name
```

Где:
- `postgresql://` - обязательный префикс
- `username` - имя пользователя базы данных
- `password` - пароль пользователя базы данных
- `postgres.internal` - хост для подключения (используйте именно это значение для внутреннего подключения на Render)
- `5432` - порт PostgreSQL (обычно 5432)
- `database_name` - имя базы данных

Если вы копируете URL из Render, убедитесь, что он начинается с `postgresql://`, а не просто с `://` или другого значения.

## Важные замечания

1. Для правильной работы приложения с базой данных убедитесь, что:
   - База данных и веб-сервис находятся в одном регионе
   - Используется **Internal Database URL** для подключения
   - Установлена переменная `RENDER=true`

2. Если возникают проблемы с подключением к базе данных:
   - Проверьте журналы Render для выявления ошибок
   - Убедитесь, что используется правильный формат URL для базы данных
   - Попробуйте перезапустить сервис после изменения настроек

3. Для локальной разработки:
   - Создайте файл `.env` в корне проекта
   - Добавьте в него необходимые переменные окружения (без `RENDER=true`)
   - Используйте SQLite для локальной разработки
